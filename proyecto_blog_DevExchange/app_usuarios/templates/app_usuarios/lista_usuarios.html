
{% extends 'base.html' %}

{% block contenido %}
	<h1>Lista de usuarios</h1>

	{% if messages %}
		<ul class="messages">
			{% for message in messages %}
				<li class="{{ message.tags }}">{{ message }}</li>
			{% endfor %}
		</ul>
	{% endif %}

	{% if usuarios %}
		<table class="table">
			<thead>
				<tr>
					<th>Usuario</th>
					<th>Email</th>
					<th>Staff</th>
					<th>Superusuario</th>
					<th>Fecha de registro</th>
					<th>Acciones</th>
				</tr>
			</thead>
			<tbody>
				{% for usuario in usuarios %}
					<tr>
						<td>{{ usuario.username }}</td>
						<td>{{ usuario.email }}</td>
						<td>{% if usuario.is_staff %}Sí{% else %}No{% endif %}</td>
						<td>{% if usuario.is_superuser %}Sí{% else %}No{% endif %}</td>
						<td>{{ usuario.date_joined|date:"d/m/Y H:i" }}</td>
						<td>
                            {% if user.is_superuser %}
							<a class="btn btn-sm btn-secondary" href="{% url 'eliminar_usuario' usuario.pk %}">Ver / Eliminar</a>
							<!-- Form alternativa para eliminar directamente desde la lista -->
							<form action="{% url 'eliminar_usuario' usuario.pk %}" method="post" style="display:inline;">
								{% csrf_token %}
								<input type="hidden" name="eliminar_comentarios" value="" />
								<input type="hidden" name="eliminar_posts" value="" />
								<button type="submit" class="btn btn-sm btn-danger">Eliminar</button>
							</form>
                            {% else %}
                            <span class="text-muted">No tienes permisos para eliminar el usuario</span>
                            {% endif %}
						</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	{% else %}
		<p>No hay usuarios para mostrar.</p>
	{% endif %}

{% endblock contenido %}
