<h2>{{ post.titulo }}</h2>
<p>Total de Votos: <span id="contador-votos-{{ post.id }}">{{ post.total_votos }}</span></p>

<!-- Botones de voto -->
{% if user.is_authenticated %}
    <button onclick="handleVote({{ post.id }}, 1)" class="vote-btn upvote-btn">▲ Upvoto</button>
    <button onclick="handleVote({{ post.id }}, -1)" class="vote-btn downvote-btn">▼ Downvoto</button>
{% else %}
    <p>Inicia sesión para votar.</p>
{% endif %}

<!-- Incluir jQuery o usar Fetch API para la petición AJAX -->
<script src="code.jquery.com"></script>
<script>
function handleVote(postId, tipoVoto) {
    // Es crucial incluir el token CSRF para peticiones POST en Django
    var csrftoken = "{{ csrf_token }}"; 

    $.ajax({
        type: 'POST',
        url: `/post/${postId}/voto/${tipoVoto}/`,
        headers: { 'X-CSRFToken': csrftoken },
        success: function(response) {
            // Actualiza el contador en la página con la respuesta del servidor
            $(`#contador-votos-${postId}`).text(response.total_votos);
            console.log(response.message);
        },
        error: function(response) {
            console.error("Error votando:", response.responseJSON.message);
            alert("Hubo un error al votar.");
        }
    });
}
</script>